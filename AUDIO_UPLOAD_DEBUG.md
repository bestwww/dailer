# üéµ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –∞—É–¥–∏–æ—Ñ–∞–π–ª–æ–≤

## üö® –ü—Ä–æ–±–ª–µ–º–∞

–ù–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ –∞—É–¥–∏–æ—Ñ–∞–π–ª—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∫–∞–º–ø–∞–Ω–∏–∏. –§–∞–π–ª –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è, –Ω–æ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã –∞—É–¥–∏–æ—Ñ–∞–π–ª –æ—Å—Ç–∞–µ—Ç—Å—è –ø—É—Å—Ç—ã–º.

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
```bash
# –ù–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ –∑–∞–ø—É—Å—Ç–∏—Ç–µ:
git pull origin main
chmod +x debug-audio-upload.sh
./debug-audio-upload.sh http://YOUR_SERVER_IP:3000
```

### 2. –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps -a | grep dialer

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ backend
docker logs --tail 50 dialer_backend | grep -i audio

# –ü—Ä–æ–≤–µ—Ä–∫–∞ endpoint'–∞
curl http://localhost:3000/api/health
```

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. –ü–∞–ø–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
**–°–∏–º–ø—Ç–æ–º—ã:** –û—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ
```bash
# –†–µ—à–µ–Ω–∏–µ:
docker exec dialer_backend mkdir -p /app/audio
docker exec dialer_backend chmod 755 /app/audio
docker-compose restart backend
```

### 2. –ü—Ä–æ–±–ª–µ–º—ã —Å volume'–∞–º–∏ Docker
**–°–∏–º–ø—Ç–æ–º—ã:** –§–∞–π–ª—ã –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ volume'–æ–≤:
docker volume ls | grep dialer
docker inspect dialer_v1_audio_volume

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ volume'–∞–º–∏:
docker-compose down
docker-compose up -d --build
```

### 3. –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
**–°–∏–º–ø—Ç–æ–º—ã:** –ë–æ–ª—å—à–∏–µ —Ñ–∞–π–ª—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
docker exec dialer_backend printenv | grep AUDIO
```

### 4. –ü—Ä–æ–±–ª–µ–º—ã —Å CORS –∏–ª–∏ network
**–°–∏–º–ø—Ç–æ–º—ã:** –ó–∞–ø—Ä–æ—Å—ã –Ω–µ –¥–æ—Ö–æ–¥—è—Ç –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏:
docker network ls
docker network inspect dialer_v1_dialer_network

# –¢–µ—Å—Ç connectivity:
docker exec dialer_frontend ping backend
```

### 5. –û—à–∏–±–∫–∏ multer middleware
**–°–∏–º–ø—Ç–æ–º—ã:** 400/500 –æ—à–∏–±–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
```bash
# –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏:
docker logs -f dialer_backend | grep -E "(multer|upload|audio)"
```

## üéØ –ü–æ—à–∞–≥–æ–≤–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
```bash
# 1. –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã?
docker ps

# 2. Backend –∑–¥–æ—Ä–æ–≤?
curl http://localhost:3000/health

# 3. –ü–∞–ø–∫–∞ audio —Å—É—â–µ—Å—Ç–≤—É–µ—Ç?
docker exec dialer_backend ls -la /app/audio
```

### –®–∞–≥ 2: –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏
```bash
# –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
echo "test audio" > test.mp3

# –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–±—â–∏–π endpoint
curl -X POST -F "audio=@test.mp3" http://localhost:3000/api/audio/upload

# –¢–µ—Å—Ç–∏—Ä—É–µ–º endpoint –∫–∞–º–ø–∞–Ω–∏–∏ (–∑–∞–º–µ–Ω–∏—Ç–µ 1 –Ω–∞ ID —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –∫–∞–º–ø–∞–Ω–∏–∏)
curl -X POST -F "audio=@test.mp3" http://localhost:3000/api/campaigns/1/audio
```

### –®–∞–≥ 3: –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤
```bash
# –õ–æ–≥–∏ –≤–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏
docker logs -f dialer_backend &

# –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ UI
# –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –æ—à–∏–±–æ–∫
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ—à–µ–Ω–∏—è

- [ ] Backend –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –∑–¥–æ—Ä–æ–≤
- [ ] –ü–∞–ø–∫–∞ `/app/audio` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∑–∞–ø–∏—Å–∏  
- [ ] Volume'—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] Endpoint'—ã `/api/audio/upload` –∏ `/api/campaigns/:id/audio` –æ—Ç–≤–µ—á–∞—é—Ç
- [ ] –ù–µ—Ç –æ—à–∏–±–æ–∫ CORS –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- [ ] Multer middleware –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞–º–ø–∞–Ω–∏–π
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –∞—É–¥–∏–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

## üöÄ –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

```bash
# –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:
cd /path/to/your/project
git pull origin main
docker-compose down
docker-compose up -d --build
./debug-audio-upload.sh
```

## üìû –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ

–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:

‚úÖ **–£—Å–ø–µ—à–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞:**
```
üéµ –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞ –¥–ª—è –∫–∞–º–ø–∞–Ω–∏–∏: 1
üìà –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏: 50%
üìà –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏: 100%
‚úÖ –û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ - —Å—Ç–∞—Ç—É—Å: 200
‚úÖ –ê—É–¥–∏–æ—Ñ–∞–π–ª —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω
```

‚ùå **–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö:**
```
‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞: [–¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ]
‚ùå –°—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞: 500
‚ùå –î–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç–∞: {error: "–æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏"}
```

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- `debug-docker.sh` - –æ–±—â–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- `debug-audio-upload.sh` - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∞—É–¥–∏–æ
- `quick-check.md` - –±—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

1. **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤:** –õ–∏–º–∏—Ç 10MB –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
2. **–§–æ—Ä–º–∞—Ç—ã:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è MP3, WAV, M4A
3. **–ö–æ–¥–∏—Ä–æ–≤–∫–∞:** –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∫–∏—Ä–∏–ª–ª–∏—Ü–∞ –≤ –∏–º–µ–Ω–∞—Ö —Ñ–∞–π–ª–æ–≤
4. **–¢–∞–π–º–∞—É—Ç—ã:** –£–≤–µ–ª–∏—á–µ–Ω —Ç–∞–π–º–∞—É—Ç –¥–æ 30 —Å–µ–∫—É–Ω–¥ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
5. **–ü—Ä–æ–≥—Ä–µ—Å—Å:** –î–æ–±–∞–≤–ª–µ–Ω –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: $(date '+%Y-%m-%d %H:%M:%S')* 