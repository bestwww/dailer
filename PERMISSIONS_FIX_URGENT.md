# üö® –≠–ö–°–¢–†–ï–ù–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞–º

## ‚ùå **–í–´–Ø–í–õ–ï–ù–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**
```json
{"success":false,"error":"EACCES: permission denied, open '/app/audio/campaign-audio-*.mp3'"}
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–∞–ø–∫–∞ `/app/audio` –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç `root`, –∞ Node.js –∑–∞–ø—É—â–µ–Ω –ø–æ–¥ `nodeuser`

## ‚ö° **–ë–´–°–¢–†–û–ï –†–ï–®–ï–ù–ò–ï (2 –º–∏–Ω—É—Ç—ã)**

### 1. –ù–∞ —Ç–µ—Å—Ç–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```bash
# –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–¥
git pull origin main

# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
./fix-audio-permissions.sh
```

### 2. –ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –≤—Ä—É—á–Ω—É—é:
```bash
# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–ø–∫–µ
docker exec dialer_backend chown -R nodeuser:nodejs /app/audio
docker exec dialer_backend chmod -R 755 /app/audio

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
docker exec dialer_backend ls -la /app/audio
```

### 3. –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏:
```bash
# –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
echo "test audio" > test.mp3

# –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É
curl -X POST -F "audio=@test.mp3" http://localhost:3000/api/campaigns/1/audio
```

## ‚úÖ **–û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢**

**–í–º–µ—Å—Ç–æ:**
```json
{"success":false,"error":"EACCES: permission denied"}
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```json
{"success":true,"data":{...},"message":"–ê—É–¥–∏–æ —Ñ–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ"}
```

## üîß **–î–û–õ–ì–û–°–†–û–ß–ù–û–ï –†–ï–®–ï–ù–ò–ï**

–î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã –≤ –±—É–¥—É—â–µ–º:

```bash
# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º Dockerfile
docker-compose down
docker-compose up -d --build
```

## üìä **–ü–†–û–í–ï–†–ö–ê –†–ï–®–ï–ù–ò–Ø**

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### –í –ª–æ–≥–∞—Ö backend:
```
‚úÖ Uploaded audio for campaign 1: filename.mp3
```

### –í –±—Ä–∞—É–∑–µ—Ä–µ:
```
üéµ –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –∞—É–¥–∏–æ—Ñ–∞–π–ª–∞ –¥–ª—è –∫–∞–º–ø–∞–Ω–∏–∏: 1
üìà –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏: 100%
‚úÖ –ê—É–¥–∏–æ—Ñ–∞–π–ª "filename.mp3" —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω
```

## üÜò **–ï–°–õ–ò –ù–ï –†–ê–ë–û–¢–ê–ï–¢**

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
docker exec dialer_backend whoami
docker exec dialer_backend id

# –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É –∑–∞–Ω–æ–≤–æ
docker exec dialer_backend rm -rf /app/audio
docker exec dialer_backend mkdir -p /app/audio
docker exec dialer_backend chown nodeuser:nodejs /app/audio
docker exec dialer_backend chmod 755 /app/audio

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
docker-compose restart backend
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
```bash
docker logs -f dialer_backend | grep -i audio
```

---

## üéØ **–ò–¢–û–ì**

‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–∞–ø–∫–µ `/app/audio`  
‚úÖ **–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–∏—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü–∞ –Ω–∞ `nodeuser:nodejs`  
‚úÖ **–í—Ä–µ–º—è —Ä–µ—à–µ–Ω–∏—è:** 2 –º–∏–Ω—É—Ç—ã  
‚úÖ **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ê—É–¥–∏–æ—Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ  

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ `./fix-audio-permissions.sh` –∏ –ø—Ä–æ–±–ª–µ–º–∞ –±—É–¥–µ—Ç —Ä–µ—à–µ–Ω–∞!** 